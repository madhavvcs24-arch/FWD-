<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Admin Dashboard | Alumni Connect</title>

  <!-- Fonts & Icons -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />

  <style>
    :root{
      --bg:#f6f8fb; --panel:#fff; --accent:#6366f1; --accent-2:#4f46e5; --primary:#1a2238; --muted:#6b7280; --radius:12px;
    }
    *{box-sizing:border-box}
    body{ margin:0; font-family:"Poppins",sans-serif; background:linear-gradient(180deg,var(--bg),#eef2ff 140%); color:var(--primary) }

    header{ background:var(--panel); border-bottom:1px solid rgba(17,24,39,0.06); position:sticky; top:0; z-index:200; }
    .header-inner{ max-width:1200px; margin:0 auto; padding:14px 20px; display:flex; justify-content:space-between; align-items:center; gap:12px; }
    .brand{ display:flex; gap:10px; align-items:center; color:var(--primary); text-decoration:none }
    .brand i{ font-size:20px; color:var(--accent-2) }
    .actions{ display:flex; gap:10px; align-items:center }

    .btn{ padding:8px 12px; border-radius:8px; border:0; cursor:pointer; font-weight:600 }
    .btn-ghost{ background:transparent; border:1px solid rgba(17,24,39,0.06) }
    .btn-primary{ background:var(--accent); color:#fff }
    .btn-danger{ background:#ef4444; color:#fff }

    .container{ max-width:1200px; margin:28px auto; padding:0 20px; }

    .grid{ display:grid; grid-template-columns: 1fr 420px; gap:20px; align-items:start; }
    .panel{ background:var(--panel); border-radius:12px; padding:16px; box-shadow:0 12px 40px rgba(17,24,39,0.06) }

    h2{ margin:0 0 12px 0 }

    /* small table */
    table{ width:100%; border-collapse:collapse; }
    th,td{ padding:10px 8px; text-align:left; border-bottom:1px solid rgba(17,24,39,0.04); font-size:0.95rem; color:var(--primary) }
    th{ font-weight:600; color:var(--muted); font-size:0.85rem; text-transform:uppercase; letter-spacing:0.6px }
    .actions-col{ display:flex; gap:6px }

    /* responsive */
    @media(max-width:980px){
      .grid{ grid-template-columns: 1fr; }
    }

    /* modal */
    .modal-back{ position:fixed; inset:0; display:none; background:rgba(2,6,23,0.5); align-items:center; justify-content:center; z-index:9999; padding:20px }
    .modal{ width:100%; max-width:720px; background:var(--panel); border-radius:10px; padding:18px; }

    .small{ color:var(--muted); font-size:0.9rem }
  </style>
</head>
<body>

  <header>
    <div class="header-inner">
      <a class="brand" href="index.html"><i class="fa-solid fa-graduation-cap"></i><span style="margin-left:8px;font-weight:700">Alumni Connect — Admin</span></a>

      <div class="actions">
        <a class="btn btn-ghost" href="dashboard.html"><i class="fa-solid fa-user"></i>&nbsp;Student View</a>
        <a class="btn btn-ghost" href="alumni.html"><i class="fa-solid fa-users"></i>&nbsp;Alumni Directory</a>
        <button class="btn btn-primary" onclick="openAddModal('company')"><i class="fa-solid fa-building-circle-plus"></i>&nbsp;Add Company</button>
        <button class="btn btn-primary" onclick="openAddModal('alumni')"><i class="fa-solid fa-user-plus"></i>&nbsp;Add Alumni</button>
        <button class="btn btn-ghost" onclick="goHome()">Back to Site</button>
        <button class="btn btn-danger" onclick="logout()">Logout</button>
      </div>
    </div>
  </header>

  <main class="container">
    <div style="margin-bottom:18px">
      <h1 style="margin:0;font-size:1.4rem">Admin Dashboard</h1>
      <p class="small">Manage companies and alumni (demo). Replace client actions with API calls to persist changes.</p>
    </div>

    <div class="grid">
      <!-- LEFT: List panels -->
      <div>
        <div class="panel" style="margin-bottom:20px">
          <h2>Companies</h2>
          <table id="companiesTable" aria-label="Companies table">
            <thead>
              <tr><th>Company</th><th>Latest Role</th><th>Package</th><th></th></tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>

        <div class="panel">
          <h2 style="display:flex;justify-content:space-between;align-items:center">
            Alumni
            <span class="small">Total: <strong id="alumniCount">0</strong></span>
          </h2>
          <table id="alumniTable" aria-label="Alumni table">
            <thead>
              <tr><th>Name</th><th>Company</th><th>Role</th><th></th></tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>

      <!-- RIGHT: Quick detail / activity panel -->
      <aside class="panel">
        <h2>Quick Actions</h2>
        <p class="small">Click Edit to update an entry (demo). Delete removes the entry locally (confirm required).</p>

        <div style="margin-top:12px">
          <label class="small">Search companies</label>
          <input id="searchAdmin" placeholder="Search by name..." style="width:100%;padding:8px;border-radius:8px;border:1px solid rgba(17,24,39,0.06);margin-top:6px" />
        </div>

        <div style="margin-top:14px">
          <button class="btn btn-primary" onclick="refreshTables()">Refresh</button>
          <button class="btn btn-ghost" onclick="exportData()">Export JSON</button>
        </div>

        <div style="margin-top:18px">
          <h3 style="margin:0 0 8px 0">Selected</h3>
          <div id="selectedInfo" class="small">No selection</div>
        </div>
      </aside>
    </div>
  </main>

  <!-- modal (add/edit) -->
  <div id="modal" class="modal-back" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="modal" role="document">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <h3 id="modalTitle">Modal</h3>
        <button onclick="closeModal()" style="background:transparent;border:0;font-size:18px;cursor:pointer">✕</button>
      </div>

      <form id="modalForm" style="margin-top:12px">
        <div id="modalFields"></div>
        <div style="margin-top:12px; display:flex; gap:8px; justify-content:flex-end">
          <button type="button" class="btn btn-ghost" onclick="closeModal()">Cancel</button>
          <button type="submit" class="btn btn-primary">Save</button>
        </div>
      </form>
    </div>
  </div>

  <script>
    // demo data
    let companies = [
      { id:'google', name:'Google', latestRole:'Software Engineer', package:'₹25 LPA', years:['2024','2023'], about:'Tech giant' , website:'https://careers.google.com' },
      { id:'microsoft', name:'Microsoft', latestRole:'Software Engineer', package:'₹22 LPA', years:['2024','2023'] },
      { id:'salesforce', name:'Salesforce', latestRole:'Cloud Specialist', package:'₹18 LPA', years:['2023','2022'] },
      { id:'tcs', name:'TCS', latestRole:'Systems Engineer', package:'₹8 LPA', years:['2024','2023'] }
    ];

    let alumni = [
      { id:'arjun', name:'Arjun Mehta', company:'Google', role:'Software Engineer', batch:'2021', email:'arjun@example.com' },
      { id:'priya', name:'Priya Patel', company:'Google', role:'Frontend Developer', batch:'2024', email:'priya.patel@example.com' },
      { id:'bhawna', name:'Bhawna Nair', company:'Microsoft', role:'Data Analyst', batch:'2022', email:'bhawna@example.com' }
    ];

    // helpers to render tables
    const compTbody = document.querySelector('#companiesTable tbody');
    const alumniTbody = document.querySelector('#alumniTable tbody');
    const alumniCountEl = document.getElementById('alumniCount');
    const searchAdmin = document.getElementById('searchAdmin');
    const selectedInfo = document.getElementById('selectedInfo');

    function renderCompanies(filter='') {
      compTbody.innerHTML = '';
      const list = companies.filter(c => c.name.toLowerCase().includes(filter.toLowerCase()));
      list.forEach(c=>{
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${c.name}</td>
          <td>${c.latestRole}</td>
          <td>${c.package}</td>
          <td class="actions-col">
            <div class="actions-col">
              <button class="btn btn-ghost" onclick="viewCompany('${c.id}')"><i class="fa-solid fa-eye"></i></button>
              <button class="btn btn-ghost" onclick="openEditModal('company','${c.id}')"><i class="fa-solid fa-pen-to-square"></i></button>
              <button class="btn btn-danger" onclick="deleteCompany('${c.id}')"><i class="fa-solid fa-trash"></i></button>
            </div>
          </td>
        `;
        compTbody.appendChild(tr);
      });
    }

    function renderAlumni() {
      alumniTbody.innerHTML = '';
      alumni.forEach(a=>{
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${a.name}</td>
          <td>${a.company}</td>
          <td>${a.role}</td>
          <td class="actions-col">
            <div class="actions-col">
              <button class="btn btn-ghost" onclick="viewAlumni('${a.id}')"><i class="fa-solid fa-eye"></i></button>
              <button class="btn btn-ghost" onclick="openEditModal('alumni','${a.id}')"><i class="fa-solid fa-pen-to-square"></i></button>
              <button class="btn btn-danger" onclick="deleteAlumni('${a.id}')"><i class="fa-solid fa-trash"></i></button>
            </div>
          </td>
        `;
        alumniTbody.appendChild(tr);
      });
      alumniCountEl.textContent = alumni.length;
    }

    function refreshTables(){
      renderCompanies(searchAdmin.value || '');
      renderAlumni();
      selectedInfo.textContent = 'No selection';
    }

    // initial
    refreshTables();

    // view handlers (demo)
    function viewCompany(id){
      const c = companies.find(x=>x.id===id);
      if(!c) return alert('Company not found');
      selectedInfo.innerHTML = `<strong>${c.name}</strong><div class="small">${c.latestRole} · ${c.package}</div>`;
      alert(`${c.name}\n\nAbout: ${c.about || '—'}\nLatest: ${c.latestRole} (${c.package})`);
    }

    function viewAlumni(id){
      const a = alumni.find(x=>x.id===id);
      if(!a) return alert('Alumni not found');
      selectedInfo.innerHTML = `<strong>${a.name}</strong><div class="small">${a.role} at ${a.company}</div>`;
      alert(`${a.name}\n\nRole: ${a.role}\nCompany: ${a.company}\nEmail: ${a.email}`);
    }

    // delete (demo)
    function deleteCompany(id){
      if (!confirm('Delete this company? This is a demo action and will only remove it locally.')) return;
      companies = companies.filter(c=>c.id!==id);
      refreshTables();
    }
    function deleteAlumni(id){
      if (!confirm('Delete this alumni? This is a demo action and will only remove it locally.')) return;
      alumni = alumni.filter(a=>a.id!==id);
      refreshTables();
    }

    // modal add/edit
    const modal = document.getElementById('modal');
    const modalTitle = document.getElementById('modalTitle');
    const modalFields = document.getElementById('modalFields');
    const modalForm = document.getElementById('modalForm');
    let currentMode = null; // 'company'|'alumni'
    let currentEditId = null;

    function openAddModal(type){
      currentMode = type; currentEditId = null;
      modalTitle.textContent = `Add ${type === 'company' ? 'Company' : 'Alumni'}`;
      buildModalFields(type);
      openModal();
    }

    function openEditModal(type, id){
      currentMode = type; currentEditId = id;
      modalTitle.textContent = `Edit ${type === 'company' ? 'Company' : 'Alumni'}`;
      buildModalFields(type, id);
      openModal();
    }

    function buildModalFields(type, id=null){
      modalFields.innerHTML = '';
      if(type === 'company'){
        const data = companies.find(c=>c.id===id) || {};
        modalFields.innerHTML = `
          <label class="small">Name</label>
          <input name="name" value="${escapeHtml(data.name||'')}" style="width:100%;padding:8px;border-radius:6px;border:1px solid rgba(17,24,39,0.06)" />
          <label class="small" style="margin-top:8px">Latest role</label>
          <input name="latestRole" value="${escapeHtml(data.latestRole||'')}" style="width:100%;padding:8px;border-radius:6px;border:1px solid rgba(17,24,39,0.06)" />
          <label class="small" style="margin-top:8px">Package</label>
          <input name="package" value="${escapeHtml(data.package||'')}" style="width:100%;padding:8px;border-radius:6px;border:1px solid rgba(17,24,39,0.06)" />
          <label class="small" style="margin-top:8px">About</label>
          <textarea name="about" style="width:100%;padding:8px;border-radius:6px;border:1px solid rgba(17,24,39,0.06)">${escapeHtml(data.about||'')}</textarea>
        `;
      } else {
        const data = alumni.find(a=>a.id===id) || {};
        modalFields.innerHTML = `
          <label class="small">Full name</label>
          <input name="name" value="${escapeHtml(data.name||'')}" style="width:100%;padding:8px;border-radius:6px;border:1px solid rgba(17,24,39,0.06)" />
          <label class="small" style="margin-top:8px">Company</label>
          <input name="company" value="${escapeHtml(data.company||'')}" style="width:100%;padding:8px;border-radius:6px;border:1px solid rgba(17,24,39,0.06)" />
          <label class="small" style="margin-top:8px">Role</label>
          <input name="role" value="${escapeHtml(data.role||'')}" style="width:100%;padding:8px;border-radius:6px;border:1px solid rgba(17,24,39,0.06)" />
          <label class="small" style="margin-top:8px">Email</label>
          <input name="email" value="${escapeHtml(data.email||'')}" style="width:100%;padding:8px;border-radius:6px;border:1px solid rgba(17,24,39,0.06)" />
        `;
      }
    }

    modalForm.addEventListener('submit', (e) => {
      e.preventDefault();
      const formData = new FormData(modalForm);
      if(currentMode === 'company'){
        const obj = {
          id: currentEditId || (formData.get('name')||'').toLowerCase().replace(/\s+/g,'-'),
          name: formData.get('name')||'Untitled',
          latestRole: formData.get('latestRole')||'—',
          package: formData.get('package')||'—',
          about: formData.get('about')||''
        };
        if(currentEditId){
          companies = companies.map(c => c.id === currentEditId ? {...c,...obj} : c);
        } else {
          companies.unshift(obj);
        }
      } else if(currentMode === 'alumni'){
        const obj = {
          id: currentEditId || (formData.get('name')||'').toLowerCase().replace(/\s+/g,'-'),
          name: formData.get('name')||'Unnamed',
          company: formData.get('company')||'—',
          role: formData.get('role')||'—',
          email: formData.get('email')||''
        };
        if(currentEditId){
          alumni = alumni.map(a=> a.id===currentEditId ? {...a,...obj} : a);
        } else {
          alumni.unshift(obj);
        }
      }
      closeModal();
      refreshTables();
    });

    function openModal(){ modal.style.display = 'flex'; modal.setAttribute('aria-hidden','false'); }
    function closeModal(){ modal.style.display = 'none'; modal.setAttribute('aria-hidden','true'); currentEditId=null; currentMode=null; modalForm.reset(); }

    function escapeHtml(unsafe){
      return (unsafe||'').replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]));
    }

    function openEditModal(type,id){ /* defined above but keep for inline safe calls */ }

    // quick methods
    function exportData(){
      const payload = { companies, alumni };
      const blob = new Blob([JSON.stringify(payload, null, 2)], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url; a.download = 'alumni-data.json'; a.click();
      URL.revokeObjectURL(url);
    }

    function goHome(){ window.location.href = 'index.html'; }
    function logout(){ alert('Admin logged out'); window.location.href='index.html'; }

    // search handler
    searchAdmin.addEventListener('input', (e)=> renderCompanies(e.target.value));

    // ensure functions used inline exist in global scope
    window.openAddModal = openAddModal;
    window.openEditModal = openEditModal;
    window.deleteCompany = deleteCompany;
    window.deleteAlumni = deleteAlumni;
    window.viewCompany = viewCompany;
    window.viewAlumni = viewAlumni;

  </script>
</body>
</html>
