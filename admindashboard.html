<!DOCTYPE html>
<html>
<head>
  <title>Admin Dashboard</title>
  <script type="module">
    import { db } from "./firebase.js";
    import {
      collection, addDoc, getDocs, doc, updateDoc
    } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

    const form = document.getElementById("form");
    const list = document.getElementById("list");

    async function load() {
      list.innerHTML = "";
      const snap = await getDocs(collection(db, "alumni"));
      snap.forEach(d => {
        const a = d.data();
        list.innerHTML += `
          <div>
            <input value="${a.name}" id="n-${d.id}">
            <input value="${a.company}" id="c-${d.id}">
            <input value="${a.designation}" id="d-${d.id}">
            <button onclick="save('${d.id}')">Save</button>
          </div>`;
      });
    }

    window.save = async id => {
      await updateDoc(doc(db, "alumni", id), {
        name: document.getElementById("n-"+id).value,
        company: document.getElementById("c-"+id).value,
        designation: document.getElementById("d-"+id).value
      });
      alert("Updated");
    };

    form.onsubmit = async e => {
      e.preventDefault();
      await addDoc(collection(db, "alumni"), {
        name: name.value,
        company: company.value,
        designation: designation.value,
        linkedin: linkedin.value
      });
      form.reset();
      load();
    };

    load();
  </script>
</head>

<body>
  <h2>Add Alumni</h2>
  <form id="form">
    <input id="name" placeholder="Name" required>
    <input id="company" placeholder="Company" required>
    <input id="designation" placeholder="Designation" required>
    <input id="linkedin" placeholder="LinkedIn">
    <button>Add</button>
  </form>

  <h2>Existing Alumni</h2>
  <div id="list"></div>
</body>
</html>
