<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Admin Dashboard – Manage Alumni</title>

<style>
body { font-family: Arial; background:#f5f7fb; }
header { background:#1e2a44; color:white; padding:15px; }
table { width:100%; background:white; border-collapse:collapse; margin-top:15px; }
th,td { padding:12px; border-bottom:1px solid #ddd; }
button { padding:6px 12px; cursor:pointer; }
#modal {
  display:none; position:fixed; inset:0;
  background:rgba(0,0,0,.5);
  justify-content:center; align-items:center;
}
.modal-box { background:white; padding:20px; width:420px; }
input,textarea { width:100%; margin-bottom:10px; padding:8px; }
</style>
</head>

<body>

<header>Admin Dashboard – Manage Alumni</header>
<button onclick="openAdd()">+ Add Alumni</button>

<table>
<thead>
<tr>
<th>Name</th><th>Company</th><th>Designation</th><th>Actions</th>
</tr>
</thead>
<tbody id="tbody"></tbody>
</table>

<div id="modal">
  <div class="modal-box">
    <h3 id="title"></h3>
    <form id="form">
      <input name="name" placeholder="Name">
      <input name="company" placeholder="Company">
      <input name="designation" placeholder="Designation">
      <input name="email" placeholder="Email">
      <input name="batch" placeholder="Batch">
      <input name="branch" placeholder="Branch">
      <input name="linkedin" placeholder="LinkedIn">
      <input name="photourl" placeholder="Photo URL">
      <textarea name="about" placeholder="About"></textarea>
      <button type="submit">Save</button>
      <button type="button" onclick="closeModal()">Cancel</button>
    </form>
  </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getFirestore, collection, getDocs, getDoc, doc, addDoc, updateDoc, deleteDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

const app = initializeApp({
  apiKey: "AIzaSyBSa1065ebQotb2Gy2YyMCO-7DVl6E7XzE",
  authDomain: "fwd-a5a74.firebaseapp.com",
  projectId: "fwd-a5a74"
});

const db = getFirestore(app);
const tbody = document.getElementById("tbody");
const modal = document.getElementById("modal");
const form = document.getElementById("form");
const title = document.getElementById("title");

let editId = null;

async function load() {
  tbody.innerHTML = "";
  const snap = await getDocs(collection(db,"alumni"));
  snap.forEach(d=>{
    const a=d.data();
    tbody.innerHTML += `
      <tr>
        <td>${a.name||""}</td>
        <td>${a.company||""}</td>
        <td>${a.designation||""}</td>
        <td>
          <button onclick="edit('${d.id}')">Edit</button>
          <button onclick="del('${d.id}')">Delete</button>
        </td>
      </tr>`;
  });
}
load();

window.openAdd=()=>{
  editId=null;
  title.innerText="Add Alumni";
  form.reset();
  modal.style.display="flex";
};

window.edit=async(id)=>{
  editId=id;
  title.innerText="Edit Alumni";
  const snap=await getDoc(doc(db,"alumni",id));
  const a=snap.data();
  Object.keys(form).forEach(k=>{
    if(form[k]) form[k].value=a[k]||"";
  });
  modal.style.display="flex";
};

form.onsubmit=async(e)=>{
  e.preventDefault();
  const data=Object.fromEntries(new FormData(form));
  if(editId) await updateDoc(doc(db,"alumni",editId),data);
  else await addDoc(collection(db,"alumni"),data);
  modal.style.display="none";
  load();
};

window.del=async(id)=>{
  if(confirm("Delete?")){
    await deleteDoc(doc(db,"alumni",id));
    load();
  }
};
window.closeModal=()=>modal.style.display="none";
</script>

</body>
</html>
